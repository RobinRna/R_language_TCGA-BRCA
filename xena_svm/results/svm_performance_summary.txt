--- Caret SVM Model Tuning Results ---

Method used: svmRadial (RBF Kernel)
Resampling Method:  cv  ( 5 -fold CV)
Metric for optimization:  Mean_F1 

Optimal Hyperparameters (bestTune):
   sigma          C
50 0.001 0.01160933

Performance for Optimal Hyperparameters (from CV on training data):
   sigma          C logLoss       AUC     prAUC Accuracy     Kappa
50 0.001 0.01160933 1.19075 0.7147869 0.4426642  0.48218 0.2627334
     Mean_F1 Mean_Sensitivity Mean_Specificity Mean_Pos_Pred_Value
50 0.5179323        0.4934327        0.8139291           0.4994418
   Mean_Neg_Pred_Value Mean_Precision Mean_Recall Mean_Detection_Rate
50           0.8151131      0.4994418   0.4934327            0.120545
   Mean_Balanced_Accuracy logLossSD      AUCSD    prAUCSD AccuracySD
50              0.6536809 0.1235201 0.07507149 0.08440204  0.1257048
     KappaSD  Mean_F1SD Mean_SensitivitySD Mean_SpecificitySD
50 0.1751309 0.08910589          0.1284972         0.04715624
   Mean_Pos_Pred_ValueSD Mean_Neg_Pred_ValueSD Mean_PrecisionSD
50             0.1642893            0.04449167        0.1642893
   Mean_RecallSD Mean_Detection_RateSD Mean_Balanced_AccuracySD
50     0.1284972            0.03142619               0.08743863

Full Tuning Grid Results (all hyperparameter combinations tried):
   sigma            C  logLoss       AUC     prAUC  Accuracy       Kappa
1  1e-05 9.765625e-04 1.279533 0.5293135 0.2904256 0.4527645  0.00000000
2  1e-05 1.602217e-03 1.279191 0.5292190 0.2905462 0.4527645  0.00000000
3  1e-05 2.628711e-03 1.278607 0.5281276 0.2883456 0.4527645  0.00000000
4  1e-05 4.312850e-03 1.277344 0.5362696 0.2984073 0.4527645  0.00000000
5  1e-05 7.075966e-03 1.275119 0.5488560 0.2992600 0.4219599 -0.00826004
6  1e-05 1.160933e-02 1.276372 0.5745293 0.3121592 0.3919657  0.01063258
7  1e-05 1.904709e-02 1.280745 0.5967848 0.3279908 0.3140931 -0.01482410
8  1e-05 3.125000e-02 1.274004 0.6254348 0.3592231 0.3411592  0.02183883
9  1e-05 5.127096e-02 1.249856 0.6739928 0.3941223 0.4594896  0.18115394
10 1e-05 8.411876e-02 1.244576 0.6808855 0.4109969 0.3976544  0.12107928
11 1e-05 1.380112e-01 1.212926 0.6984348 0.4353509 0.3990883  0.11006558
12 1e-05 2.264309e-01 1.194298 0.7050524 0.4474692 0.4364952  0.18202317
13 1e-05 3.714986e-01 1.203679 0.7013794 0.4432780 0.4151802  0.15533461
14 1e-05 6.095068e-01 1.220732 0.6814988 0.4274487 0.3980596  0.13856575
15 1e-05 1.000000e+00 1.199631 0.6975742 0.4387753 0.4044925  0.14874502
16 1e-05 1.640671e+00 1.211768 0.6977817 0.4414076 0.3814417  0.09727680
17 1e-05 2.691800e+00 1.187145 0.7160037 0.4579847 0.4485135  0.20891541
18 1e-05 4.416358e+00 1.205442 0.7015495 0.4407182 0.4151179  0.15998741
19 1e-05 7.245789e+00 1.195150 0.7021640 0.4424825 0.4731677  0.21473879
20 1e-05 1.188795e+01 1.175652 0.6874521 0.4277092 0.4659186  0.15445132
21 1e-05 1.950422e+01 1.174186 0.6902638 0.4375654 0.4894194  0.19554431
22 1e-05 3.200000e+01 1.177386 0.7112142 0.4473175 0.4897682  0.20413569
23 1e-04 9.765625e-04 1.273969 0.5701270 0.3013463 0.4221898  0.01798534
24 1e-04 1.602217e-03 1.271840 0.6029744 0.3378706 0.3878882  0.04477341
25 1e-04 2.628711e-03 1.266053 0.6501323 0.3695143 0.4085681  0.11282410
26 1e-04 4.312850e-03 1.255950 0.6767972 0.4041632 0.3986285  0.11831862
27 1e-04 7.075966e-03 1.247565 0.6951044 0.4195335 0.4081668  0.13255462
28 1e-04 1.160933e-02 1.221928 0.7132990 0.4442643 0.4322989  0.18177380
29 1e-04 1.904709e-02 1.215816 0.6939802 0.4236246 0.3679369  0.09356077
30 1e-04 3.125000e-02 1.193290 0.7175839 0.4569441 0.4457491  0.21116440
31 1e-04 5.127096e-02 1.208734 0.7094845 0.4443252 0.4417806  0.20127306
32 1e-04 8.411876e-02 1.189148 0.7120877 0.4548122 0.4391935  0.19790226
33 1e-04 1.380112e-01 1.187761 0.7118742 0.4529538 0.4586850  0.23054862
     Mean_F1 Mean_Sensitivity Mean_Specificity Mean_Pos_Pred_Value
1        NaN        0.2500000        0.7500000                 NaN
2        NaN        0.2500000        0.7500000                 NaN
3        NaN        0.2500000        0.7500000                 NaN
4        NaN        0.2500000        0.7500000                 NaN
5        NaN        0.2407407        0.7496798                 NaN
6        NaN        0.2553743        0.7535310                 NaN
7        NaN        0.2588617        0.7428651                 NaN
8        NaN        0.2925291        0.7512582                 NaN
9        NaN        0.3669037        0.7949744                 NaN
10 0.4768207        0.3574903        0.7763065           0.6729167
11       NaN        0.3395545        0.7743164                 NaN
12 0.4618470        0.4100279        0.7931148           0.5376309
13 0.4277819        0.4040119        0.7839446           0.5536905
14 0.4583629        0.3920413        0.7810911           0.5137586
15 0.4160185        0.4065727        0.7829731           0.4872155
16 0.3747408        0.3538153        0.7696200           0.5401888
17 0.4589464        0.4386049        0.7990409           0.5469378
18 0.4408653        0.4114193        0.7853722           0.5341070
19 0.4267507        0.4225968        0.8016962           0.5367770
20 0.4220035        0.3680482        0.7869306           0.5075310
21 0.4746663        0.3993316        0.7953498           0.6262239
22 0.4481568        0.3921887        0.7987083           0.5536955
23       NaN        0.2523789        0.7561272                 NaN
24       NaN        0.2852707        0.7593270                 NaN
25       NaN        0.3282958        0.7764733                 NaN
26       NaN        0.3416459        0.7771960                 NaN
27       NaN        0.3511072        0.7802311                 NaN
28 0.4428325        0.3927441        0.7938913           0.5217742
29 0.4007989        0.3660380        0.7674492           0.5109512
30 0.4426632        0.4459566        0.8002282           0.5387464
31 0.4506003        0.4494291        0.7964695           0.5379248
32 0.4223035        0.4299269        0.7967256           0.5324073
33 0.4670771        0.4699018        0.8047533           0.5402114
   Mean_Neg_Pred_Value Mean_Precision Mean_Recall Mean_Detection_Rate
1                  NaN            NaN   0.2500000          0.11319112
2                  NaN            NaN   0.2500000          0.11319112
3                  NaN            NaN   0.2500000          0.11319112
4                  NaN            NaN   0.2500000          0.11319112
5            0.7868967            NaN   0.2407407          0.10548997
6            0.7562330            NaN   0.2553743          0.09799143
7            0.7418838            NaN   0.2588617          0.07852328
8            0.7513981            NaN   0.2925291          0.08528979
9            0.7991158            NaN   0.3669037          0.11487239
10           0.7809076      0.6729167   0.3574903          0.09941360
11           0.7753128            NaN   0.3395545          0.09977206
12           0.7931206      0.5376309   0.4100279          0.10912381
13           0.7886446      0.5536905   0.4040119          0.10379505
14           0.7835845      0.5137586   0.3920413          0.09951490
15           0.7833335      0.4872155   0.4065727          0.10112312
16           0.7723904      0.5401888   0.3538153          0.09536041
17           0.8039988      0.5469378   0.4386049          0.11212838
18           0.7882345      0.5341070   0.4114193          0.10377947
19           0.8021145      0.5367770   0.4225968          0.11829193
20           0.7939155      0.5075310   0.3680482          0.11647964
21           0.8031788      0.6262239   0.3993316          0.12235486
22           0.8075221      0.5536955   0.3921887          0.12244204
23           0.7746259            NaN   0.2523789          0.10554744
24           0.7621502            NaN   0.2852707          0.09697204
25           0.7798181            NaN   0.3282958          0.10214202
26           0.7824789            NaN   0.3416459          0.09965712
27           0.7835779            NaN   0.3511072          0.10204169
28           0.7986370      0.5217742   0.3927441          0.10807471
29           0.7699776      0.5109512   0.3660380          0.09198422
30           0.8017185      0.5387464   0.4459566          0.11143727
31           0.7977536      0.5379248   0.4494291          0.11044516
32           0.7991395      0.5324073   0.4299269          0.10979836
33           0.8068230      0.5402114   0.4699018          0.11467124
   Mean_Balanced_Accuracy   logLossSD      AUCSD    prAUCSD  AccuracySD
1               0.5000000 0.009433781 0.08771951 0.05620227 0.009322643
2               0.5000000 0.009226618 0.08020532 0.05433988 0.009322643
3               0.5000000 0.008546861 0.08905754 0.05549748 0.009322643
4               0.5000000 0.008385863 0.09096657 0.06136804 0.009322643
5               0.4952103 0.015792850 0.09175639 0.05599939 0.050131932
6               0.5044526 0.029811393 0.08430207 0.05842967 0.022905950
7               0.5008634 0.042574003 0.09425150 0.08143438 0.084926025
8               0.5218937 0.061351466 0.08919809 0.07398633 0.087261474
9               0.5809391 0.047503437 0.07067312 0.06170808 0.032206338
10              0.5668984 0.057160839 0.07993241 0.07591732 0.129679085
11              0.5569355 0.052450092 0.06093598 0.05512257 0.053907378
12              0.6015714 0.054251923 0.05820076 0.03052945 0.074565504
13              0.5939783 0.039801106 0.03645009 0.02719458 0.055858913
14              0.5865662 0.044903335 0.05199340 0.04196308 0.115665355
15              0.5947729 0.048393095 0.05974020 0.05026142 0.093614386
16              0.5617177 0.062361160 0.06859828 0.04384848 0.101265652
17              0.6188229 0.045881069 0.03613065 0.01643941 0.083082374
18              0.5983958 0.066631213 0.06818663 0.04446667 0.131587528
19              0.6121465 0.053223689 0.05365502 0.04320869 0.043880418
20              0.5774894 0.049136270 0.07836328 0.05643199 0.057763210
21              0.5973407 0.054308291 0.07389894 0.05440412 0.082922942
22              0.5954485 0.050346145 0.05035619 0.04561494 0.037576244
23              0.5042531 0.019506505 0.08378646 0.05294768 0.031830917
24              0.5222988 0.036758271 0.08260324 0.06950808 0.060590245
25              0.5523845 0.053684152 0.09465749 0.07930867 0.083224914
26              0.5594210 0.052142327 0.08355993 0.07296096 0.040077704
27              0.5656692 0.066352342 0.06982371 0.06646705 0.104191704
28              0.5933177 0.058549943 0.06958000 0.05644773 0.111086050
29              0.5667436 0.077369471 0.05314150 0.07424915 0.089023223
30              0.6230924 0.049567734 0.04917190 0.03736481 0.054934515
31              0.6229493 0.089392196 0.07543320 0.06754938 0.133677904
32              0.6133262 0.070209082 0.05334058 0.04629794 0.081018477
33              0.6373275 0.054477915 0.04600311 0.04377887 0.080868143
      KappaSD  Mean_F1SD Mean_SensitivitySD Mean_SpecificitySD
1  0.00000000         NA         0.00000000         0.00000000
2  0.00000000         NA         0.00000000         0.00000000
3  0.00000000         NA         0.00000000         0.00000000
4  0.00000000         NA         0.00000000         0.00000000
5  0.07773097         NA         0.03268400         0.01897979
6  0.04687927         NA         0.02226412         0.01210519
7  0.07928727         NA         0.04554068         0.02228163
8  0.13285486         NA         0.07813574         0.03495731
9  0.06813263         NA         0.05497771         0.01798044
10 0.17770666         NA         0.10577497         0.04888531
11 0.07644321         NA         0.03604074         0.02120910
12 0.12104820 0.05191172         0.08796161         0.03219403
13 0.04600508 0.02968980         0.03457208         0.01304645
14 0.17729115 0.13479343         0.12743629         0.04700026
15 0.12103389 0.07818820         0.06883982         0.03352281
16 0.14778997 0.10220641         0.08500340         0.04161009
17 0.10173136 0.07543339         0.07820465         0.02709021
18 0.19631231 0.12269295         0.12779545         0.05403686
19 0.07702631 0.05874943         0.05229143         0.02088858
20 0.12576817 0.05419000         0.08946424         0.03155692
21 0.15037722 0.03260028         0.10738461         0.03700066
22 0.06977463 0.07071542         0.06189849         0.01752933
23 0.06304023         NA         0.02852169         0.01517055
24 0.05282645         NA         0.02494706         0.01479011
25 0.10763998         NA         0.05275241         0.02971678
26 0.03643733         NA         0.02369644         0.01062099
27 0.13873575         NA         0.07597276         0.03824284
28 0.16259417         NA         0.09575750         0.04478840
29 0.11867913 0.02963254         0.07442020         0.03306436
30 0.07060286 0.05301927         0.06137967         0.01918145
31 0.19130077 0.12600233         0.12234849         0.05263151
32 0.11000328 0.05949998         0.07074068         0.03100913
33 0.11565600 0.09187177         0.08849016         0.03083986
   Mean_Pos_Pred_ValueSD Mean_Neg_Pred_ValueSD Mean_PrecisionSD
1                     NA                    NA               NA
2                     NA                    NA               NA
3                     NA                    NA               NA
4                     NA                    NA               NA
5                     NA           0.067917111               NA
6                     NA           0.022047621               NA
7                     NA           0.026997333               NA
8                     NA           0.035739824               NA
9                     NA           0.014957567               NA
10                    NA           0.050325300               NA
11                    NA           0.024920374               NA
12            0.06707842           0.033552389       0.06707842
13            0.02577607           0.008901919       0.02577607
14            0.15163255           0.046535995       0.15163255
15            0.08097999           0.032580736       0.08097999
16            0.08989878           0.041590369       0.08989878
17            0.04126582           0.025023821       0.04126582
18            0.08057733           0.052800398       0.08057733
19            0.10091300           0.019544715       0.10091300
20            0.07337213           0.037097186       0.07337213
21            0.04154849           0.044517465       0.04154849
22            0.04505180           0.019386892       0.04505180
23                    NA           0.029990520               NA
24                    NA           0.018828066               NA
25                    NA           0.032112943               NA
26                    NA           0.011649156               NA
27                    NA           0.036765423               NA
28                    NA           0.044882851               NA
29            0.07237212           0.030103479       0.07237212
30            0.03646293           0.018394674       0.03646293
31            0.09504310           0.050268953       0.09504310
32            0.03035112           0.031342304       0.03035112
33            0.09312388           0.029428495       0.09312388
   Mean_RecallSD Mean_Detection_RateSD Mean_Balanced_AccuracySD
1     0.00000000           0.002330661               0.00000000
2     0.00000000           0.002330661               0.00000000
3     0.00000000           0.002330661               0.00000000
4     0.00000000           0.002330661               0.00000000
5     0.03268400           0.012532983               0.02569610
6     0.02226412           0.005726488               0.01684471
7     0.04554068           0.021231506               0.03306991
8     0.07813574           0.021815369               0.05605867
9     0.05497771           0.008051584               0.03642342
10    0.10577497           0.032419771               0.07709948
11    0.03604074           0.013476844               0.02760965
12    0.08796161           0.018641376               0.05903962
13    0.03457208           0.013964728               0.02280306
14    0.12743629           0.028916339               0.08710839
15    0.06883982           0.023403597               0.05052756
16    0.08500340           0.025316413               0.06270578
17    0.07820465           0.020770594               0.05264460
18    0.12779545           0.032896882               0.09076907
19    0.05229143           0.010970104               0.03515154
20    0.08946424           0.014440802               0.06046785
21    0.10738461           0.020730735               0.07180643
22    0.06189849           0.009394061               0.03944754
23    0.02852169           0.007957729               0.02173957
24    0.02494706           0.015147561               0.01849911
25    0.05275241           0.020806229               0.04093184
26    0.02369644           0.010019426               0.01506641
27    0.07597276           0.026047926               0.05670107
28    0.09575750           0.027771513               0.07006456
29    0.07442020           0.022255806               0.05299129
30    0.06137967           0.013733629               0.03928344
31    0.12234849           0.033419476               0.08736124
32    0.07074068           0.020254619               0.05012728
33    0.08849016           0.020217036               0.05920978
 [ reached 'max' / getOption("max.print") -- omitted 77 rows ]

SVM调优结果已写入: ' results/svm_performance_summary.txt ' (将追加测试集结果)

步骤5: 在测试集上评估最优SVM模型 (更全面)...

SVM调优和测试集评估结果已完整保存到: ' results/svm_performance_summary.txt '
   sigma          C
50 0.001 0.01160933
Number of features used in model:  500 
Subtype categories (original readable names):  Basal-like, HER2-enriched, Luminal A, Luminal B 

Confusion Matrix (Test Set - Original Readable Names):
               Reference
Prediction      Basal-like HER2-enriched Luminal A Luminal B
  Basal-like             6             1         1         5
  HER2-enriched          1             6         4         1
  Luminal A              3             1        21         7
  Luminal B              9             4        19        13

Overall Statistics (Test Set):
      Accuracy          Kappa  AccuracyLower  AccuracyUpper 
    0.45098039     0.22842091     0.35224199     0.55263989 
  AccuracyNull AccuracyPValue  McnemarPValue 
    0.44117647     0.45877810     0.08006146 

Statistics by Class (Test Set - Original Readable Names):
                     Sensitivity Specificity Pos Pred Value
Class: Basal.like         0.3158      0.9157         0.4615
Class: HER2.enriched      0.5000      0.9333         0.5000
Class: Luminal.A          0.4667      0.8070         0.6562
Class: Luminal.B          0.5000      0.5789         0.2889
                     Neg Pred Value Precision Recall     F1 Prevalence
Class: Basal.like            0.8539    0.4615 0.3158 0.3750     0.1863
Class: HER2.enriched         0.9333    0.5000 0.5000 0.5000     0.1176
Class: Luminal.A             0.6571    0.6562 0.4667 0.5455     0.4412
Class: Luminal.B             0.7719    0.2889 0.5000 0.3662     0.2549
                     Detection Rate Detection Prevalence
Class: Basal.like           0.05882               0.1275
Class: HER2.enriched        0.05882               0.1176
Class: Luminal.A            0.20588               0.3137
Class: Luminal.B            0.12745               0.4412
                     Balanced Accuracy
Class: Basal.like               0.6157
Class: HER2.enriched            0.7167
Class: Luminal.A                0.6368
Class: Luminal.B                0.5395

--- Averaged Metrics (Test Set - SVM) ---
Macro-Averaged Precision:  0.4767 
Macro-Averaged Recall:     0.4456 
Macro-Averaged F1-Score:   0.4467 
Weighted-Averaged Precision:  0.5080 
Weighted-Averaged Recall:     0.4510 
Weighted-Averaged F1-Score:   0.4627 
